import{e as I,r as d,j as e,P as S,l as M,u as R,x as B,a as F,A as V,B as f,U as _,C as L,o as T,Z as Y,b as q,y as G,z as H}from"./index-BjO4OBGt.js";import{u as O}from"./useMutation-EJ4WbH_H.js";import{C as N,a as v,b as y,c as w}from"./card-DW_tR_lU.js";import{B as h}from"./badge-DEp-JO2V.js";import{A as Z}from"./arrow-left-PafVpdP1.js";import{C as Q}from"./chart-column-78LhE8Zo.js";import"./utils-km2FGkQ4.js";var b="Progress",j=100,[X,ce]=I(b),[z,K]=X(b),k=d.forwardRef((t,r)=>{const{__scopeProgress:a,value:i=null,max:n,getValueLabel:m=W,...u}=t;(n||n===0)&&!P(n)&&console.error(J(`${n}`,"Progress"));const o=P(n)?n:j;i!==null&&!C(i,o)&&console.error(ee(`${i}`,"Progress"));const l=C(i,o)?i:null,s=c(l)?m(l,o):void 0;return e.jsx(z,{scope:a,value:l,max:o,children:e.jsx(S.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":c(l)?l:void 0,"aria-valuetext":s,role:"progressbar","data-state":E(l,o),"data-value":l??void 0,"data-max":o,...u,ref:r})})});k.displayName=b;var U="ProgressIndicator",$=d.forwardRef((t,r)=>{const{__scopeProgress:a,...i}=t,n=K(U,a);return e.jsx(S.div,{"data-state":E(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...i,ref:r})});$.displayName=U;function W(t,r){return`${Math.round(t/r*100)}%`}function E(t,r){return t==null?"indeterminate":t===r?"complete":"loading"}function c(t){return typeof t=="number"}function P(t){return c(t)&&!isNaN(t)&&t>0}function C(t,r){return c(t)&&!isNaN(t)&&t<=r&&t>=0}function J(t,r){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${r}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${j}\`.`}function ee(t,r){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${r}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${j} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var A=k,se=$;const D=d.forwardRef(({className:t,value:r,...a},i)=>e.jsx(A,{ref:i,className:M("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...a,children:e.jsx(se,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})}));D.displayName=A.displayName;const g=[{id:"free",name:"Free Explorer",price:"$0",period:"/month",description:"Perfect for getting started",features:["3 scans per month","1 store location per scan","Basic clearance filtering","30-day scan history","Email support"],scanLimit:3,storeLimit:1,icon:e.jsx(Y,{className:"w-6 h-6"}),popular:!1},{id:"basic",name:"Pro Hunter",price:"$9.99",period:"/month",description:"Great for regular deal hunters",features:["50 scans per month","5 store locations per scan","Advanced filtering & sorting","Unlimited scan history","Price alerts & notifications","Export results to CSV","Priority email support"],scanLimit:50,storeLimit:5,icon:e.jsx(q,{className:"w-6 h-6"}),popular:!0},{id:"premium",name:"Business Elite",price:"$24.99",period:"/month",description:"For businesses and power users",features:["Unlimited scans per month","25 store locations per scan","All advanced features","Real-time stock monitoring","Custom price alerts","API access for integrations","Export to CSV, PDF, Excel","Priority phone support","Custom reports & analytics"],scanLimit:999,storeLimit:25,icon:e.jsx(L,{className:"w-6 h-6"}),popular:!1}];function de(){var l;const[,t]=R(),{toast:r}=B(),{user:a}=F(),i=d.useMemo(()=>{const s=g.find(p=>p.id===((a==null?void 0:a.subscriptionPlan)||"free"));return{scansUsed:2,scansLimit:(s==null?void 0:s.scanLimit)||3,storesPerScan:(s==null?void 0:s.storeLimit)||1,resetDate:new Date(2025,2,15)}},[a==null?void 0:a.subscriptionPlan]),n=O({mutationFn:async s=>(await G("POST","/api/subscriptions/create",{planId:s})).json(),onSuccess:s=>{s.clientSecret?window.location.href=s.checkoutUrl:(H.invalidateQueries({queryKey:["/api/auth/me"]}),r({title:"Subscription Updated",description:"Your subscription has been updated successfully."}))},onError:s=>{r({title:"Subscription Error",description:s.message||"Failed to update subscription.",variant:"destructive"})}}),m=()=>{t("/")},u=s=>{if(!a){t("/auth");return}n.mutate(s)},o=(a==null?void 0:a.subscriptionPlan)||"free";return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(V,{}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(f,{variant:"ghost",onClick:m,"data-testid":"button-back",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Back to Home"]}),e.jsxs(f,{variant:"outline",onClick:()=>t("/profile"),className:"flex items-center gap-2","data-testid":"button-view-profile",children:[e.jsx(_,{className:"w-4 h-4"}),"View Profile"]})]}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("div",{className:"inline-flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center shadow-lg floating-element",children:e.jsx(L,{className:"w-6 h-6 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold gradient-text",children:"Manage Your Subscription"})]}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"Unlock more stores and advanced features with our subscription plans"})]}),a&&e.jsxs(N,{className:"mb-8 max-w-4xl mx-auto bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950/30 dark:to-purple-950/30",children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5 text-blue-600"}),"Current Usage - ",((l=g.find(s=>s.id===a.subscriptionPlan))==null?void 0:l.name)||"Free Explorer"]})}),e.jsx(w,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Monthly Scans"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[i.scansUsed," / ",i.scansLimit===999?"âˆž":i.scansLimit]})]}),e.jsx(D,{value:i.scansUsed/i.scansLimit*100,className:"h-2","data-testid":"progress-scans-used"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Resets ",i.resetDate.toLocaleDateString()]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Stores Per Scan"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Up to ",i.storesPerScan]})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full",children:e.jsx("div",{className:"h-full bg-green-500 rounded-full w-full"})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Based on distance from your ZIP"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Plan Status"}),e.jsx(h,{variant:"secondary",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100",children:"Active"})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full w-full"})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Next billing: ",i.resetDate.toLocaleDateString()]})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto",children:g.map(s=>e.jsxs(N,{className:`relative ${s.popular?"border-primary shadow-lg scale-105":""} ${o===s.id?"ring-2 ring-primary":""}`,"data-testid":`card-plan-${s.id}`,children:[s.popular&&e.jsx(h,{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 bg-primary",children:"Most Popular"}),o===s.id&&e.jsx(h,{className:"absolute -top-3 right-4 bg-green-500",children:"Current Plan"}),e.jsxs(v,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-2 text-primary",children:s.icon}),e.jsx(y,{className:"text-2xl",children:s.name}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-4xl font-bold text-foreground",children:s.price}),e.jsx("span",{className:"text-muted-foreground",children:s.period})]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s.description})]}),e.jsxs(w,{children:[e.jsx("ul",{className:"space-y-3 mb-6",children:s.features.map((x,p)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-foreground",children:x})]},p))}),e.jsx(f,{onClick:()=>u(s.id),disabled:n.isPending||o===s.id,className:"w-full",variant:s.popular?"default":"outline","data-testid":`button-select-${s.id}`,children:n.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2"}),"Processing..."]}):o===s.id?"Current Plan":o!=="free"&&s.id==="free"?"Downgrade":s.id==="free"?"Get Started":"Upgrade"})]})]},s.id))}),e.jsxs("div",{className:"mt-16 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"Frequently Asked Questions"}),e.jsxs("div",{className:"max-w-2xl mx-auto space-y-4 text-left",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-2",children:"Can I change my plan anytime?"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Yes, you can upgrade or downgrade your plan at any time. Changes take effect immediately."})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-2",children:"What happens if I downgrade?"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Your scan coverage will be reduced to match your new plan, but your scan history will be preserved."})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-2",children:"Can I cancel anytime?"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Yes, you can cancel your subscription at any time. You'll keep access until the end of your billing period."})]})]})]})]})]})}export{de as default};
