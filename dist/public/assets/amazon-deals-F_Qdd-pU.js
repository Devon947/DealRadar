import{r as a,j as e,A as h,aj as t,b as y,B as D}from"./index-BjO4OBGt.js";import{C as u,a as g,c as j,b as S}from"./card-DW_tR_lU.js";import{B as r}from"./badge-DEp-JO2V.js";import{P as p}from"./package-Bu2EzKa3.js";import{U as k}from"./users-CsX7cK6N.js";import{E as C}from"./external-link-CWfG4zue.js";function z(){const[l,d]=a.useState([]),[i,f]=a.useState({totalDeals:0,activeDeals:0,lastUpdate:new Date().toISOString()}),[N,m]=a.useState(!0),[v,n]=a.useState(null);return a.useEffect(()=>{const s=async()=>{try{m(!0);const o=await fetch("/api/telegram/deals"),x=await fetch("/api/telegram/stats");if(o.ok&&x.ok){const w=await o.json(),b=await x.json();d(w||[]),f(b||{totalDeals:0,activeDeals:0,lastUpdate:new Date().toISOString()}),n(null)}else n("Failed to load deals")}catch{n("Failed to load deals"),d([])}finally{m(!1)}};s();const c=setInterval(s,3e4);return()=>clearInterval(c)},[]),v?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(h,{}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-destructive mb-2",children:"Error Loading Deals"}),e.jsx("p",{className:"text-muted-foreground",children:"Unable to fetch Amazon deals. Please try again later."})]})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(h,{}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Amazon Deals"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time deals from our Telegram bot"})]}),i&&e.jsxs("div",{className:"text-right",children:[e.jsxs(r,{variant:"secondary",className:"mb-2",children:[i.totalDeals," Total Deals"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last updated: ",new Date(i.lastUpdate).toLocaleTimeString()]})]})]})}),N?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((s,c)=>e.jsxs(u,{className:"h-80",children:[e.jsxs(g,{children:[e.jsx(t,{className:"h-4 w-3/4"}),e.jsx(t,{className:"h-3 w-1/2"})]}),e.jsxs(j,{children:[e.jsx(t,{className:"h-32 w-full mb-4"}),e.jsx(t,{className:"h-8 w-full"})]})]},c))}):l&&l.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(s=>e.jsxs(u,{className:"hover:shadow-lg transition-shadow","data-testid":`card-deal-${s.id}`,children:[e.jsxs(g,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx(S,{className:"text-lg line-clamp-2 leading-tight","data-testid":`text-product-name-${s.id}`,children:s.productName}),s.discount&&e.jsx(r,{variant:"destructive",className:"shrink-0",children:s.discount})]}),s.category&&e.jsxs(r,{variant:"outline",className:"w-fit",children:[e.jsx(p,{className:"w-3 h-3 mr-1"}),s.category]})]}),e.jsxs(j,{className:"space-y-4",children:[s.imageUrl&&e.jsx("div",{className:"aspect-video bg-muted rounded-lg overflow-hidden",children:e.jsx("img",{src:s.imageUrl,alt:s.productName,className:"w-full h-full object-cover",loading:"lazy"})}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"space-y-1",children:[s.originalPrice&&s.currentPrice&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold text-foreground","data-testid":`text-current-price-${s.id}`,children:["$",s.currentPrice.toFixed(2)]}),e.jsxs("span",{className:"text-sm line-through text-muted-foreground",children:["$",s.originalPrice.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[s.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:s.rating})]}),s.reviewCount&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"w-3 h-3"}),e.jsx("span",{children:s.reviewCount.toLocaleString()})]})]})]})}),s.availability&&e.jsx(r,{variant:s.availability.toLowerCase().includes("stock")?"default":"secondary",children:s.availability}),e.jsx(D,{asChild:!0,className:"w-full","data-testid":`button-view-deal-${s.id}`,children:e.jsxs("a",{href:s.productUrl,target:"_blank",rel:"noopener noreferrer",children:["View Deal ",e.jsx(C,{className:"w-4 h-4 ml-2"})]})})]})]},s.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"No Deals Available"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Our Telegram bot hasn't found any deals yet. Check back soon for the latest Amazon deals!"})]})]})]})}export{z as default};
